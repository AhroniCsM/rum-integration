(function (g, f) {
    if ("object" == typeof exports && "object" == typeof module) {
      module.exports = f();
    } else if ("function" == typeof define && define.amd) {
      define("rrwebPluginConsoleRecord", [], f);
    } else if ("object" == typeof exports) {
      exports["rrwebPluginConsoleRecord"] = f();
    } else {
      g["rrwebPluginConsoleRecord"] = f();
    }
  }(this, () => {
var exports = {};
var module = { exports };
"use strict";var k=Object.defineProperty,z=(e,t,n)=>t in e?k(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,A=(e,t,n)=>(z(e,typeof t!="symbol"?t+"":t,n),n);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});var P=Object.defineProperty,j=(e,t,n)=>t in e?P(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,b=(e,t,n)=>(j(e,typeof t!="symbol"?t+"":t,n),n),Z,Q=Object.defineProperty,U=(e,t,n)=>t in e?Q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,S=(e,t,n)=>(U(e,typeof t!="symbol"?t+"":t,n),n);function $(e){const t=e==null?void 0:e.host;return(t==null?void 0:t.shadowRoot)===e}class q{constructor(){S(this,"idNodeMap",new Map),S(this,"nodeMetaMap",new WeakMap)}getId(t){var n;if(!t)return-1;const r=(n=this.getMeta(t))==null?void 0:n.id;return r!=null?r:-1}getNode(t){return this.idNodeMap.get(t)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(t){return this.nodeMetaMap.get(t)||null}removeNodeFromMap(t){const n=this.getId(t);this.idNodeMap.delete(n),t.childNodes&&t.childNodes.forEach(r=>this.removeNodeFromMap(r))}has(t){return this.idNodeMap.has(t)}hasNode(t){return this.nodeMetaMap.has(t)}add(t,n){const r=n.id;this.idNodeMap.set(r,t),this.nodeMetaMap.set(t,n)}replace(t,n){const r=this.getNode(t);if(r){const o=this.nodeMetaMap.get(r);o&&this.nodeMetaMap.set(n,o)}this.idNodeMap.set(t,n)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function ee(){return new q}const te=-2;function G(e,t,n){if(!e)return!1;if(e.nodeType!==e.ELEMENT_NODE)return n?G(e.parentNode,t,n):!1;for(let r=e.classList.length;r--;){const o=e.classList[r];if(t.test(o))return!0}return n?G(e.parentNode,t,n):!1}function ne(e,t,n=document){const r={capture:!0,passive:!0};return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t,r)}const C=`Please stop import mirror directly. Instead of that,\r
now you can use replayer.getMirror() to access the mirror instance of a replayer,\r
or you can use record.mirror to access the mirror instance during recording.`;let E={map:{},getId(){return console.error(C),-1},getNode(){return console.error(C),null},removeNodeFromMap(){console.error(C)},has(){return console.error(C),!1},reset(){console.error(C)}};typeof window!="undefined"&&window.Proxy&&window.Reflect&&(E=new Proxy(E,{get(e,t,n){return t==="map"&&console.error(C),Reflect.get(e,t,n)}}));function re(e,t,n={}){let r=null,o=0;return function(...c){const i=Date.now();!o&&n.leading===!1&&(o=i);const s=t-(i-o),l=this;s<=0||s>t?(r&&(clearTimeout(r),r=null),o=i,e.apply(l,c)):!r&&n.trailing!==!1&&(r=setTimeout(()=>{o=n.leading===!1?0:Date.now(),r=null,e.apply(l,c)},s))}}function W(e,t,n,r,o=window){const c=o.Object.getOwnPropertyDescriptor(e,t);return o.Object.defineProperty(e,t,r?n:{set(i){setTimeout(()=>{n.set.call(this,i)},0),c&&c.set&&c.set.call(this,i)}}),()=>W(e,t,c||{},!0)}function oe(e,t,n){try{if(!(t in e))return()=>{};const r=e[t],o=n(r);return typeof o=="function"&&(o.prototype=o.prototype||{},Object.defineProperties(o,{__rrweb_original__:{enumerable:!1,value:r}})),e[t]=o,()=>{e[t]=r}}catch(r){return()=>{}}}let X=Date.now;/[1-9][0-9]{12}/.test(Date.now().toString())||(X=()=>new Date().getTime());function ie(e){var t,n,r,o,c,i;const s=e.document;return{left:s.scrollingElement?s.scrollingElement.scrollLeft:e.pageXOffset!==void 0?e.pageXOffset:(s==null?void 0:s.documentElement.scrollLeft)||((n=(t=s==null?void 0:s.body)==null?void 0:t.parentElement)==null?void 0:n.scrollLeft)||((r=s==null?void 0:s.body)==null?void 0:r.scrollLeft)||0,top:s.scrollingElement?s.scrollingElement.scrollTop:e.pageYOffset!==void 0?e.pageYOffset:(s==null?void 0:s.documentElement.scrollTop)||((c=(o=s==null?void 0:s.body)==null?void 0:o.parentElement)==null?void 0:c.scrollTop)||((i=s==null?void 0:s.body)==null?void 0:i.scrollTop)||0}}function se(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function le(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function B(e){return e?e.nodeType===e.ELEMENT_NODE?e:e.parentElement:null}function ce(e,t,n,r){if(!e)return!1;const o=B(e);if(!o)return!1;try{if(typeof t=="string"){if(o.classList.contains(t)||r&&o.closest("."+t)!==null)return!0}else if(G(o,t,r))return!0}catch(c){}return!!(n&&(o.matches(n)||r&&o.closest(n)!==null))}function ae(e,t){return t.getId(e)!==-1}function de(e,t,n){return e.tagName==="TITLE"&&n.headTitleMutations?!0:t.getId(e)===te}function F(e,t){if($(e))return!1;const n=t.getId(e);return t.has(n)?e.parentNode&&e.parentNode.nodeType===e.DOCUMENT_NODE?!1:e.parentNode?F(e.parentNode,t):!0:!0}function ue(e){return!!e.changedTouches}function ge(e=window){"NodeList"in e&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...t)=>{let n=t[0];if(!(0 in t))throw new TypeError("1 argument is required");do if(this===n)return!0;while(n=n&&n.parentNode);return!1})}function fe(e){const t={},n=(o,c)=>{const i={value:o,parent:c,children:[]};return t[o.node.id]=i,i},r=[];for(const o of e){const{nextId:c,parentId:i}=o;if(c&&c in t){const s=t[c];if(s.parent){const l=s.parent.children.indexOf(s);s.parent.children.splice(l,0,n(o,s.parent))}else{const l=r.indexOf(s);r.splice(l,0,n(o,null))}continue}if(i in t){const s=t[i];s.children.push(n(o,s));continue}r.push(n(o,null))}return r}function R(e,t){t(e.value);for(let n=e.children.length-1;n>=0;n--)R(e.children[n],t)}function pe(e,t){return!!(e.nodeName==="IFRAME"&&t.getMeta(e))}function Ie(e,t){return!!(e.nodeName==="LINK"&&e.nodeType===e.ELEMENT_NODE&&e.getAttribute&&e.getAttribute("rel")==="stylesheet"&&t.getMeta(e))}function L(e,t){var n,r;const o=(r=(n=e.ownerDocument)==null?void 0:n.defaultView)==null?void 0:r.frameElement;if(!o||o===t)return{x:0,y:0,relativeScale:1,absoluteScale:1};const c=o.getBoundingClientRect(),i=L(o,t),s=c.height/o.clientHeight;return{x:c.x*i.relativeScale+i.x,y:c.y*i.relativeScale+i.y,relativeScale:s,absoluteScale:i.absoluteScale*s}}function me(e){return!!(e!=null&&e.shadowRoot)}function V(e,t){const n=e[t[0]];return t.length===1?n:V(n.cssRules[t[1]].cssRules,t.slice(2))}function he(e){const t=[...e],n=t.pop();return{positions:t,index:n}}function Ce(e){const t=new Set,n=[];for(let r=e.length;r--;){const o=e[r];t.has(o.id)||(n.push(o),t.add(o.id))}return n}class Ne{constructor(){b(this,"id",1),b(this,"styleIDMap",new WeakMap),b(this,"idStyleMap",new Map)}getId(t){var n;return(n=this.styleIDMap.get(t))!=null?n:-1}has(t){return this.styleIDMap.has(t)}add(t,n){if(this.has(t))return this.getId(t);let r;return n===void 0?r=this.id++:r=n,this.styleIDMap.set(t,r),this.idStyleMap.set(r,t),r}getStyle(t){return this.idStyleMap.get(t)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}function D(e){var t,n;let r=null;return((n=(t=e.getRootNode)==null?void 0:t.call(e))==null?void 0:n.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&e.getRootNode().host&&(r=e.getRootNode().host),r}function H(e){let t=e,n;for(;n=D(t);)t=n;return t}function J(e){const t=e.ownerDocument;if(!t)return!1;const n=H(e);return t.contains(n)}function Ae(e){const t=e.ownerDocument;return t?t.contains(e)||J(e):!1}const ye=Object.freeze(Object.defineProperty({__proto__:null,StyleSheetMirror:Ne,get _mirror(){return E},closestElementOfNode:B,getBaseDimension:L,getNestedRule:V,getPositionsAndIndex:he,getRootShadowHost:H,getShadowHost:D,getWindowHeight:se,getWindowScroll:ie,getWindowWidth:le,hasShadowRoot:me,hookSetter:W,inDom:Ae,isAncestorRemoved:F,isBlocked:ce,isIgnored:de,isSerialized:ae,isSerializedIframe:pe,isSerializedStylesheet:Ie,iterateResolveTree:R,legacy_isTouchEvent:ue,get nowTimestamp(){return X},on:ne,patch:oe,polyfill:ge,queueToResolveTrees:fe,shadowHostInDom:J,throttle:re,uniqueTextMutations:Ce},Symbol.toStringTag,{value:"Module"}));var v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",be=typeof Uint8Array=="undefined"?[]:new Uint8Array(256);for(var y=0;y<v.length;y++)be[v.charCodeAt(y)]=y;const we="KGZ1bmN0aW9uKCkgewogICJ1c2Ugc3RyaWN0IjsKICB2YXIgY2hhcnMgPSAiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyI7CiAgdmFyIGxvb2t1cCA9IHR5cGVvZiBVaW50OEFycmF5ID09PSAidW5kZWZpbmVkIiA/IFtdIDogbmV3IFVpbnQ4QXJyYXkoMjU2KTsKICBmb3IgKHZhciBpID0gMDsgaSA8IGNoYXJzLmxlbmd0aDsgaSsrKSB7CiAgICBsb29rdXBbY2hhcnMuY2hhckNvZGVBdChpKV0gPSBpOwogIH0KICB2YXIgZW5jb2RlID0gZnVuY3Rpb24oYXJyYXlidWZmZXIpIHsKICAgIHZhciBieXRlcyA9IG5ldyBVaW50OEFycmF5KGFycmF5YnVmZmVyKSwgaTIsIGxlbiA9IGJ5dGVzLmxlbmd0aCwgYmFzZTY0ID0gIiI7CiAgICBmb3IgKGkyID0gMDsgaTIgPCBsZW47IGkyICs9IDMpIHsKICAgICAgYmFzZTY0ICs9IGNoYXJzW2J5dGVzW2kyXSA+PiAyXTsKICAgICAgYmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpMl0gJiAzKSA8PCA0IHwgYnl0ZXNbaTIgKyAxXSA+PiA0XTsKICAgICAgYmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpMiArIDFdICYgMTUpIDw8IDIgfCBieXRlc1tpMiArIDJdID4+IDZdOwogICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaTIgKyAyXSAmIDYzXTsKICAgIH0KICAgIGlmIChsZW4gJSAzID09PSAyKSB7CiAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDEpICsgIj0iOwogICAgfSBlbHNlIGlmIChsZW4gJSAzID09PSAxKSB7CiAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDIpICsgIj09IjsKICAgIH0KICAgIHJldHVybiBiYXNlNjQ7CiAgfTsKICBjb25zdCBsYXN0QmxvYk1hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgY29uc3QgdHJhbnNwYXJlbnRCbG9iTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICBhc3luYyBmdW5jdGlvbiBnZXRUcmFuc3BhcmVudEJsb2JGb3Iod2lkdGgsIGhlaWdodCwgZGF0YVVSTE9wdGlvbnMpIHsKICAgIGNvbnN0IGlkID0gYCR7d2lkdGh9LSR7aGVpZ2h0fWA7CiAgICBpZiAoIk9mZnNjcmVlbkNhbnZhcyIgaW4gZ2xvYmFsVGhpcykgewogICAgICBpZiAodHJhbnNwYXJlbnRCbG9iTWFwLmhhcyhpZCkpCiAgICAgICAgcmV0dXJuIHRyYW5zcGFyZW50QmxvYk1hcC5nZXQoaWQpOwogICAgICBjb25zdCBvZmZzY3JlZW4gPSBuZXcgT2Zmc2NyZWVuQ2FudmFzKHdpZHRoLCBoZWlnaHQpOwogICAgICBvZmZzY3JlZW4uZ2V0Q29udGV4dCgiMmQiKTsKICAgICAgY29uc3QgYmxvYiA9IGF3YWl0IG9mZnNjcmVlbi5jb252ZXJ0VG9CbG9iKGRhdGFVUkxPcHRpb25zKTsKICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSBhd2FpdCBibG9iLmFycmF5QnVmZmVyKCk7CiAgICAgIGNvbnN0IGJhc2U2NCA9IGVuY29kZShhcnJheUJ1ZmZlcik7CiAgICAgIHRyYW5zcGFyZW50QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7CiAgICAgIHJldHVybiBiYXNlNjQ7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gIiI7CiAgICB9CiAgfQogIGNvbnN0IHdvcmtlciA9IHNlbGY7CiAgd29ya2VyLm9ubWVzc2FnZSA9IGFzeW5jIGZ1bmN0aW9uKGUpIHsKICAgIGlmICgiT2Zmc2NyZWVuQ2FudmFzIiBpbiBnbG9iYWxUaGlzKSB7CiAgICAgIGNvbnN0IHsgaWQsIGJpdG1hcCwgd2lkdGgsIGhlaWdodCwgZGF0YVVSTE9wdGlvbnMgfSA9IGUuZGF0YTsKICAgICAgY29uc3QgdHJhbnNwYXJlbnRCYXNlNjQgPSBnZXRUcmFuc3BhcmVudEJsb2JGb3IoCiAgICAgICAgd2lkdGgsCiAgICAgICAgaGVpZ2h0LAogICAgICAgIGRhdGFVUkxPcHRpb25zCiAgICAgICk7CiAgICAgIGNvbnN0IG9mZnNjcmVlbiA9IG5ldyBPZmZzY3JlZW5DYW52YXMod2lkdGgsIGhlaWdodCk7CiAgICAgIGNvbnN0IGN0eCA9IG9mZnNjcmVlbi5nZXRDb250ZXh0KCIyZCIpOwogICAgICBjdHguZHJhd0ltYWdlKGJpdG1hcCwgMCwgMCk7CiAgICAgIGJpdG1hcC5jbG9zZSgpOwogICAgICBjb25zdCBibG9iID0gYXdhaXQgb2Zmc2NyZWVuLmNvbnZlcnRUb0Jsb2IoZGF0YVVSTE9wdGlvbnMpOwogICAgICBjb25zdCB0eXBlID0gYmxvYi50eXBlOwogICAgICBjb25zdCBhcnJheUJ1ZmZlciA9IGF3YWl0IGJsb2IuYXJyYXlCdWZmZXIoKTsKICAgICAgY29uc3QgYmFzZTY0ID0gZW5jb2RlKGFycmF5QnVmZmVyKTsKICAgICAgaWYgKCFsYXN0QmxvYk1hcC5oYXMoaWQpICYmIGF3YWl0IHRyYW5zcGFyZW50QmFzZTY0ID09PSBiYXNlNjQpIHsKICAgICAgICBsYXN0QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7CiAgICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkIH0pOwogICAgICB9CiAgICAgIGlmIChsYXN0QmxvYk1hcC5nZXQoaWQpID09PSBiYXNlNjQpCiAgICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkIH0pOwogICAgICB3b3JrZXIucG9zdE1lc3NhZ2UoewogICAgICAgIGlkLAogICAgICAgIHR5cGUsCiAgICAgICAgYmFzZTY0LAogICAgICAgIHdpZHRoLAogICAgICAgIGhlaWdodAogICAgICB9KTsKICAgICAgbGFzdEJsb2JNYXAuc2V0KGlkLCBiYXNlNjQpOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkOiBlLmRhdGEuaWQgfSk7CiAgICB9CiAgfTsKfSkoKTsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW1hZ2UtYml0bWFwLWRhdGEtdXJsLXdvcmtlci1CWjFyN1JKRC5qcy5tYXAK",Ge=e=>Uint8Array.from(atob(e),t=>t.charCodeAt(0));typeof window!="undefined"&&window.Blob&&new Blob([Ge(we)],{type:"text/javascript;charset=utf-8"});try{if(Array.from([1],e=>e*2)[0]!==2){const e=document.createElement("iframe");document.body.appendChild(e),Array.from=((Z=e.contentWindow)==null?void 0:Z.Array.from)||Array.from,document.body.removeChild(e)}}catch(e){console.debug("Unable to override Array.from",e)}ee();var M;(function(e){e[e.NotStarted=0]="NotStarted",e[e.Running=1]="Running",e[e.Stopped=2]="Stopped"})(M||(M={}));class m{constructor(t){A(this,"fileName"),A(this,"functionName"),A(this,"lineNumber"),A(this,"columnNumber"),this.fileName=t.fileName||"",this.functionName=t.functionName||"",this.lineNumber=t.lineNumber,this.columnNumber=t.columnNumber}toString(){const t=this.lineNumber||"",n=this.columnNumber||"";return this.functionName?`${this.functionName} (${this.fileName}:${t}:${n})`:`${this.fileName}:${t}:${n}`}}const Ee=/(^|@)\S+:\d+/,T=/^\s*at .*(\S+:\d+|\(native\))/m,Ye=/^(eval@)?(\[native code])?$/,w={parse:function(e){return e?typeof e.stacktrace!="undefined"||typeof e["opera#sourceloc"]!="undefined"?this.parseOpera(e):e.stack&&e.stack.match(T)?this.parseV8OrIE(e):e.stack?this.parseFFOrSafari(e):(console.warn("[console-record-plugin]: Failed to parse error object:",e),[]):[]},extractLocation:function(e){if(e.indexOf(":")===-1)return[e];const n=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(e.replace(/[()]/g,""));if(!n)throw new Error(`Cannot parse given url: ${e}`);return[n[1],n[2]||void 0,n[3]||void 0]},parseV8OrIE:function(e){return e.stack.split(`
`).filter(function(n){return!!n.match(T)},this).map(function(n){n.indexOf("(eval ")>-1&&(n=n.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(\),.*$)/g,""));let r=n.replace(/^\s+/,"").replace(/\(eval code/g,"(");const o=r.match(/ (\((.+):(\d+):(\d+)\)$)/);r=o?r.replace(o[0],""):r;const c=r.split(/\s+/).slice(1),i=this.extractLocation(o?o[1]:c.pop()),s=c.join(" ")||void 0,l=["eval","<anonymous>"].indexOf(i[0])>-1?void 0:i[0];return new m({functionName:s,fileName:l,lineNumber:i[1],columnNumber:i[2]})},this)},parseFFOrSafari:function(e){return e.stack.split(`
`).filter(function(n){return!n.match(Ye)},this).map(function(n){if(n.indexOf(" > eval")>-1&&(n=n.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),n.indexOf("@")===-1&&n.indexOf(":")===-1)return new m({functionName:n});{const r=/((.*".+"[^@]*)?[^@]*)(?:@)/,o=n.match(r),c=o&&o[1]?o[1]:void 0,i=this.extractLocation(n.replace(r,""));return new m({functionName:c,fileName:i[0],lineNumber:i[1],columnNumber:i[2]})}},this)},parseOpera:function(e){return!e.stacktrace||e.message.indexOf(`
`)>-1&&e.message.split(`
`).length>e.stacktrace.split(`
`).length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(e){const t=/Line (\d+).*script (?:in )?(\S+)/i,n=e.message.split(`
`),r=[];for(let o=2,c=n.length;o<c;o+=2){const i=t.exec(n[o]);i&&r.push(new m({fileName:i[2],lineNumber:parseFloat(i[1])}))}return r},parseOpera10:function(e){const t=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,n=e.stacktrace.split(`
`),r=[];for(let o=0,c=n.length;o<c;o+=2){const i=t.exec(n[o]);i&&r.push(new m({functionName:i[3]||void 0,fileName:i[2],lineNumber:parseFloat(i[1])}))}return r},parseOpera11:function(e){return e.stack.split(`
`).filter(function(n){return!!n.match(Ee)&&!n.match(/^Error created at/)},this).map(function(n){const r=n.split("@"),o=this.extractLocation(r.pop()),i=(r.shift()||"").replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;return new m({functionName:i,fileName:o[0],lineNumber:o[1],columnNumber:o[2]})},this)}};function Ze(e){if(!e||!e.outerHTML)return"";let t="";for(;e.parentElement;){let n=e.localName;if(!n)break;n=n.toLowerCase();const r=e.parentElement,o=[];if(r.children&&r.children.length>0)for(let c=0;c<r.children.length;c++){const i=r.children[c];i.localName&&i.localName.toLowerCase&&i.localName.toLowerCase()===n&&o.push(i)}o.length>1&&(n+=`:eq(${o.indexOf(e)})`),t=n+(t?">"+t:""),e=r}return t}function Y(e){return Object.prototype.toString.call(e)==="[object Object]"}function K(e,t){if(t===0)return!0;const n=Object.keys(e);for(const r of n)if(Y(e[r])&&K(e[r],t-1))return!0;return!1}function h(e,t){const n={numOfKeysLimit:50,depthOfLimit:4};Object.assign(n,t);const r=[],o=[];return JSON.stringify(e,function(s,l){if(r.length>0){const g=r.indexOf(this);~g?r.splice(g+1):r.push(this),~g?o.splice(g,1/0,s):o.push(s),~r.indexOf(l)&&(r[0]===l?l="[Circular ~]":l="[Circular ~."+o.slice(0,r.indexOf(l)).join(".")+"]")}else r.push(l);if(l===null)return l;if(l===void 0)return"undefined";if(c(l))return i(l);if(typeof l=="bigint")return l.toString()+"n";if(l instanceof Event){const g={};for(const a in l){const d=l[a];Array.isArray(d)?g[a]=Ze(d.length?d[0]:null):g[a]=d}return g}else{if(l instanceof Node)return l instanceof HTMLElement?l?l.outerHTML:"":l.nodeName;if(l instanceof Error)return l.stack?l.stack+`
End of stack for Error object`:l.name+": "+l.message}return l});function c(s){return!!(Y(s)&&Object.keys(s).length>n.numOfKeysLimit||typeof s=="function"||Y(s)&&K(s,n.depthOfLimit))}function i(s){let l=s.toString();return n.stringLengthLimit&&l.length>n.stringLengthLimit&&(l=`${l.slice(0,n.stringLengthLimit)}...`),l}}const O={level:["assert","clear","count","countReset","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","table","time","timeEnd","timeLog","trace","warn"],lengthThreshold:1e3,logger:"console"};function Se(e,t,n){const r=n?Object.assign({},O,n):O,o=r.logger;if(!o)return()=>{};let c;typeof o=="string"?c=t[o]:c=o;let i=0,s=!1;const l=[];if(r.level.includes("error")){const a=f=>{const u=f.message,p=f.error,N=w.parse(p).map(_=>_.toString()),I=[h(u,r.stringifyOptions)];e({level:"error",trace:N,payload:I})};t.addEventListener("error",a),l.push(()=>{t.removeEventListener("error",a)});const d=f=>{let u,p;f.reason instanceof Error?(u=f.reason,p=[h(`Uncaught (in promise) ${u.name}: ${u.message}`,r.stringifyOptions)]):(u=new Error,p=[h("Uncaught (in promise)",r.stringifyOptions),h(f.reason,r.stringifyOptions)]);const N=w.parse(u).map(I=>I.toString());e({level:"error",trace:N,payload:p})};t.addEventListener("unhandledrejection",d),l.push(()=>{t.removeEventListener("unhandledrejection",d)})}for(const a of r.level)l.push(g(c,a));return()=>{l.forEach(a=>a())};function g(a,d){return a[d]?ye.patch(a,d,f=>(...u)=>{if(f.apply(this,u),!s){s=!0;try{const p=w.parse(new Error).map(I=>I.toString()).splice(1),N=u.map(I=>h(I,r.stringifyOptions));i++,i<r.lengthThreshold?e({level:d,trace:p,payload:N}):i===r.lengthThreshold&&e({level:"warn",trace:[],payload:[h("The number of log records reached the threshold.")]})}catch(p){f("rrweb logger error:",p,...u)}finally{s=!1}}}):()=>{}}}const x="rrweb/console@1",ve=e=>({name:x,observer:Se,options:e});exports.PLUGIN_NAME=x;exports.getRecordConsolePlugin=ve;
if (typeof module.exports == "object" && typeof exports == "object") {
  var __cp = (to, from, except, desc) => {
    if ((from && typeof from === "object") || typeof from === "function") {
      for (let key of Object.getOwnPropertyNames(from)) {
        if (!Object.prototype.hasOwnProperty.call(to, key) && key !== except)
        Object.defineProperty(to, key, {
          get: () => from[key],
          enumerable: !(desc = Object.getOwnPropertyDescriptor(from, key)) || desc.enumerable,
        });
      }
    }
    return to;
  };
  module.exports = __cp(module.exports, exports);
}
return module.exports;
}))
//# sourceMappingURL=rrweb-plugin-console-record.umd.min.cjs.map
