{"ast":null,"code":"import { InstrumentationBase } from '@opentelemetry/instrumentation';\nimport { DOM_INSTRUMENTATION_NAME, DOM_INSTRUMENTATION_VERSION } from './instrumentation.consts';\nimport { CoralogixAttributes } from '../constants';\nimport { CoralogixEventType } from '../types';\n// In future we can make this class more generic and add more DOM events\nexport class CoralogixDOMInstrumentation extends InstrumentationBase {\n  constructor(config) {\n    super(DOM_INSTRUMENTATION_NAME, DOM_INSTRUMENTATION_VERSION, config);\n    this.visibilityChangeHandler = () => {\n      if (document.hidden) {\n        const domSpan = this.tracer.startSpan(DOM_INSTRUMENTATION_NAME);\n        domSpan.setAttribute(CoralogixAttributes.EVENT_TYPE, CoralogixEventType.DOM);\n        domSpan.end();\n      }\n    };\n  }\n  registerToDOMEvents() {\n    document.addEventListener('visibilitychange', this.visibilityChangeHandler);\n  }\n  unregisterFromDOMEvents() {\n    document.removeEventListener('visibilitychange', this.visibilityChangeHandler);\n  }\n  init() {\n    return undefined;\n  }\n  disable() {\n    this.unregisterFromDOMEvents();\n  }\n  enable() {\n    setTimeout(() => {\n      this.registerToDOMEvents();\n    });\n  }\n}","map":{"version":3,"names":["InstrumentationBase","DOM_INSTRUMENTATION_NAME","DOM_INSTRUMENTATION_VERSION","CoralogixAttributes","CoralogixEventType","CoralogixDOMInstrumentation","constructor","config","visibilityChangeHandler","document","hidden","domSpan","tracer","startSpan","setAttribute","EVENT_TYPE","DOM","end","registerToDOMEvents","addEventListener","unregisterFromDOMEvents","removeEventListener","init","undefined","disable","enable","setTimeout"],"sources":["../../../../../libs/browser/src/instrumentations/CoralogixDOMInstrumentation.ts"],"sourcesContent":[null],"mappings":"AAAA,SACEA,mBAAmB,QAEd,gCAAgC;AACvC,SACEC,wBAAwB,EACxBC,2BAA2B,QACtB,0BAA0B;AAEjC,SAASC,mBAAmB,QAAQ,cAAc;AAClD,SAASC,kBAAkB,QAAQ,UAAU;AAE7C;AACA,OAAM,MAAOC,2BAA4B,SAAQL,mBAAmB;EAClEM,YAAYC,MAA6B;IACvC,KAAK,CAACN,wBAAwB,EAAEC,2BAA2B,EAAEK,MAAM,CAAC;IAG9D,KAAAC,uBAAuB,GAAG,MAAW;MAC3C,IAAIC,QAAQ,CAACC,MAAM,EAAE;QACnB,MAAMC,OAAO,GAAS,IAAI,CAACC,MAAM,CAACC,SAAS,CAACZ,wBAAwB,CAAC;QAErEU,OAAO,CAACG,YAAY,CAClBX,mBAAmB,CAACY,UAAU,EAC9BX,kBAAkB,CAACY,GAAG,CACvB;QAEDL,OAAO,CAACM,GAAG,EAAE;;IAEjB,CAAC;EAbD;EAeQC,mBAAmBA,CAAA;IACzBT,QAAQ,CAACU,gBAAgB,CAAC,kBAAkB,EAAE,IAAI,CAACX,uBAAuB,CAAC;EAC7E;EAEQY,uBAAuBA,CAAA;IAC7BX,QAAQ,CAACY,mBAAmB,CAC1B,kBAAkB,EAClB,IAAI,CAACb,uBAAuB,CAC7B;EACH;EAEUc,IAAIA,CAAA;IACZ,OAAOC,SAAS;EAClB;EAESC,OAAOA,CAAA;IACd,IAAI,CAACJ,uBAAuB,EAAE;EAChC;EAESK,MAAMA,CAAA;IACbC,UAAU,CAAC,MAAK;MACd,IAAI,CAACR,mBAAmB,EAAE;IAC5B,CAAC,CAAC;EACJ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}