{"ast":null,"code":"import { DEFAULT_SESSION_CONFIG } from './session.consts';\nimport { CoralogixEventType } from '../types';\nimport { DEFAULT_MS_RECORD_TIME, DEFAULT_RUM_EVENTS, MAX_MS_RECORD_TIME, MAX_RUM_EVENTS } from './sessionWithError.consts';\nimport { getSessionManager } from '../helpers';\nfunction resolveMaxRumEvents(maxRumEvents) {\n  if (!maxRumEvents) {\n    return DEFAULT_RUM_EVENTS;\n  }\n  return maxRumEvents > MAX_RUM_EVENTS ? MAX_RUM_EVENTS : maxRumEvents;\n}\nfunction resolveMaxRecordTime(maxRecordTime) {\n  if (!maxRecordTime) {\n    return DEFAULT_MS_RECORD_TIME;\n  }\n  return maxRecordTime > MAX_MS_RECORD_TIME ? MAX_MS_RECORD_TIME : maxRecordTime;\n}\nfunction resolveSessionWithErrorsConfig(config) {\n  var _a;\n  if (!config) {\n    return {\n      enable: false\n    };\n  }\n  return Object.assign(Object.assign({}, config), {\n    maxRumEvents: resolveMaxRumEvents(config.maxRumEvents),\n    maxRecordTime: resolveMaxRecordTime(config.maxRecordTime),\n    instrumentationsToSend: (_a = config.instrumentationsToSend) !== null && _a !== void 0 ? _a : {\n      [CoralogixEventType.WEB_VITALS]: true\n    }\n  });\n}\nexport function resolveSessionConfig(config) {\n  var _a;\n  if (!config) {\n    return DEFAULT_SESSION_CONFIG;\n  }\n  return Object.assign(Object.assign({}, config), {\n    sessionSampleRate: (_a = config.sessionSampleRate) !== null && _a !== void 0 ? _a : 100,\n    onlyWithErrorConfig: resolveSessionWithErrorsConfig(config.onlyWithErrorConfig)\n  });\n}\nexport function resolveSessionRecordingConfig(config) {\n  var _a;\n  if (config) {\n    return Object.assign(Object.assign({}, config), {\n      sessionRecordingSampleRate: (_a = config.sessionRecordingSampleRate) !== null && _a !== void 0 ? _a : 100\n    });\n  }\n  return;\n}\nexport function isSamplingOn(threshold) {\n  return threshold > 0 && Math.random() * 100 <= threshold;\n}\nexport const isSessionWithError = () => {\n  const {\n    onlySessionWithErrorMode,\n    cachedLogsSent\n  } = getSessionManager();\n  return onlySessionWithErrorMode && !cachedLogsSent;\n};","map":{"version":3,"names":["DEFAULT_SESSION_CONFIG","CoralogixEventType","DEFAULT_MS_RECORD_TIME","DEFAULT_RUM_EVENTS","MAX_MS_RECORD_TIME","MAX_RUM_EVENTS","getSessionManager","resolveMaxRumEvents","maxRumEvents","resolveMaxRecordTime","maxRecordTime","resolveSessionWithErrorsConfig","config","enable","Object","assign","instrumentationsToSend","_a","WEB_VITALS","resolveSessionConfig","sessionSampleRate","onlyWithErrorConfig","resolveSessionRecordingConfig","sessionRecordingSampleRate","isSamplingOn","threshold","Math","random","isSessionWithError","onlySessionWithErrorMode","cachedLogsSent"],"sources":["../../../../../libs/browser/src/session/session.helper.ts"],"sourcesContent":[null],"mappings":"AAKA,SAASA,sBAAsB,QAAQ,kBAAkB;AACzD,SAASC,kBAAkB,QAAQ,UAAU;AAC7C,SACEC,sBAAsB,EACtBC,kBAAkB,EAClBC,kBAAkB,EAClBC,cAAc,QACT,2BAA2B;AAClC,SAASC,iBAAiB,QAAQ,YAAY;AAE9C,SAASC,mBAAmBA,CAACC,YAAgC;EAC3D,IAAI,CAACA,YAAY,EAAE;IACjB,OAAOL,kBAAkB;;EAG3B,OAAOK,YAAY,GAAGH,cAAc,GAAGA,cAAc,GAAGG,YAAY;AACtE;AAEA,SAASC,oBAAoBA,CAACC,aAAiC;EAC7D,IAAI,CAACA,aAAa,EAAE;IAClB,OAAOR,sBAAsB;;EAG/B,OAAOQ,aAAa,GAAGN,kBAAkB,GACrCA,kBAAkB,GAClBM,aAAa;AACnB;AAEA,SAASC,8BAA8BA,CACrCC,MAA0C;;EAE1C,IAAI,CAACA,MAAM,EAAE;IACX,OAAO;MAAEC,MAAM,EAAE;IAAK,CAAE;;EAG1B,OAAAC,MAAA,CAAAC,MAAA,CAAAD,MAAA,CAAAC,MAAA,KACKH,MAAM;IACTJ,YAAY,EAAED,mBAAmB,CAACK,MAAM,CAACJ,YAAY,CAAC;IACtDE,aAAa,EAAED,oBAAoB,CAACG,MAAM,CAACF,aAAa,CAAC;IACzDM,sBAAsB,EAAE,CAAAC,EAAA,GAAAL,MAAM,CAACI,sBAAsB,cAAAC,EAAA,cAAAA,EAAA,GAAI;MACvD,CAAChB,kBAAkB,CAACiB,UAAU,GAAG;;EAClC;AAEL;AAEA,OAAM,SAAUC,oBAAoBA,CAClCP,MAAiC;;EAEjC,IAAI,CAACA,MAAM,EAAE;IACX,OAAOZ,sBAAsB;;EAG/B,OAAAc,MAAA,CAAAC,MAAA,CAAAD,MAAA,CAAAC,MAAA,KACKH,MAAM;IACTQ,iBAAiB,EAAE,CAAAH,EAAA,GAAAL,MAAM,CAACQ,iBAAiB,cAAAH,EAAA,cAAAA,EAAA,GAAI,GAAG;IAClDI,mBAAmB,EAAEV,8BAA8B,CACjDC,MAAM,CAACS,mBAAmB;EAC3B;AAEL;AAEA,OAAM,SAAUC,6BAA6BA,CAC3CV,MAA0C;;EAE1C,IAAIA,MAAM,EAAE;IACV,OAAAE,MAAA,CAAAC,MAAA,CAAAD,MAAA,CAAAC,MAAA,KACKH,MAAM;MACTW,0BAA0B,EAAE,CAAAN,EAAA,GAAAL,MAAM,CAACW,0BAA0B,cAAAN,EAAA,cAAAA,EAAA,GAAI;IAAG;;EAIxE;AACF;AAEA,OAAM,SAAUO,YAAYA,CAACC,SAAiB;EAC5C,OAAOA,SAAS,GAAG,CAAC,IAAIC,IAAI,CAACC,MAAM,EAAE,GAAG,GAAG,IAAIF,SAAS;AAC1D;AAEA,OAAO,MAAMG,kBAAkB,GAAGA,CAAA,KAAc;EAC9C,MAAM;IAAEC,wBAAwB;IAAEC;EAAc,CAAE,GAAGxB,iBAAiB,EAAE;EACxE,OAAOuB,wBAAwB,IAAI,CAACC,cAAc;AACpD,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}