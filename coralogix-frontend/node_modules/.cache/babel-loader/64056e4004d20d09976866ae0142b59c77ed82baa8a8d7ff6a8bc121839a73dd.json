{"ast":null,"code":"import { XMLHttpRequestInstrumentation } from '@opentelemetry/instrumentation-xml-http-request';\nimport { CoralogixAttributes } from '../constants';\nimport { CoralogixEventType } from '../types';\nimport { CoralogixLogSeverity } from '../types-external';\nimport { isNetworkError } from '../utils';\nimport { propagateTraceHeaderCorsUrls } from '../CoralogixPropgator';\nexport var XHRSource;\n(function (XHRSource) {\n  XHRSource[\"XHR\"] = \"xhr\";\n})(XHRSource || (XHRSource = {}));\nexport class CoralogixXhrInstrumentation extends XMLHttpRequestInstrumentation {\n  constructor(config) {\n    propagateTraceHeaderCorsUrls(config);\n    config.applyCustomAttributesOnSpan = (span, xhr) => {\n      const {\n        status\n      } = xhr;\n      span.setAttributes({\n        [CoralogixAttributes.SEVERITY]: isNetworkError(status) ? CoralogixLogSeverity.Error : CoralogixLogSeverity.Info,\n        [CoralogixAttributes.EVENT_TYPE]: CoralogixEventType.NETWORK_REQUEST,\n        [CoralogixAttributes.SOURCE]: XHRSource.XHR\n      });\n    };\n    super(config);\n  }\n}","map":{"version":3,"names":["XMLHttpRequestInstrumentation","CoralogixAttributes","CoralogixEventType","CoralogixLogSeverity","isNetworkError","propagateTraceHeaderCorsUrls","XHRSource","CoralogixXhrInstrumentation","constructor","config","applyCustomAttributesOnSpan","span","xhr","status","setAttributes","SEVERITY","Error","Info","EVENT_TYPE","NETWORK_REQUEST","SOURCE","XHR"],"sources":["../../../../../libs/browser/src/instrumentations/CoralogixXhrInstrumentation.ts"],"sourcesContent":[null],"mappings":"AAAA,SACEA,6BAA6B,QAExB,iDAAiD;AAExD,SAASC,mBAAmB,QAAQ,cAAc;AAClD,SAASC,kBAAkB,QAAQ,UAAU;AAC7C,SAASC,oBAAoB,QAAQ,mBAAmB;AACxD,SAASC,cAAc,QAAQ,UAAU;AACzC,SAASC,4BAA4B,QAAQ,uBAAuB;AAEpE,WAAYC,SAEX;AAFD,WAAYA,SAAS;EACnBA,SAAA,eAAW;AACb,CAAC,EAFWA,SAAS,KAATA,SAAS;AAIrB,OAAM,MAAOC,2BAA4B,SAAQP,6BAA6B;EAC5EQ,YAAYC,MAA2C;IACrDJ,4BAA4B,CAACI,MAAM,CAAC;IAEpCA,MAAM,CAACC,2BAA2B,GAAG,CAACC,IAAU,EAAEC,GAAmB,KAAI;MACvE,MAAM;QAAEC;MAAM,CAAE,GAAGD,GAAG;MAEtBD,IAAI,CAACG,aAAa,CAAC;QACjB,CAACb,mBAAmB,CAACc,QAAQ,GAAGX,cAAc,CAACS,MAAM,CAAC,GAClDV,oBAAoB,CAACa,KAAK,GAC1Bb,oBAAoB,CAACc,IAAI;QAC7B,CAAChB,mBAAmB,CAACiB,UAAU,GAAGhB,kBAAkB,CAACiB,eAAe;QACpE,CAAClB,mBAAmB,CAACmB,MAAM,GAAGd,SAAS,CAACe;OACzC,CAAC;IACJ,CAAC;IAED,KAAK,CAACZ,MAAM,CAAC;EACf","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}